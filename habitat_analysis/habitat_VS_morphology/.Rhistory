ungroup()
}
combined
morpho
#load and combine data
morpho <- read.csv("Symphyotrichum_morphometrics_final.csv", header = TRUE)
morpho
#load and combine data
morpho <- read.csv("Symphyotrichum_morphometrics_final.csv", header = TRUE)
morpho$Barcode <- NULL
morpho$Collector <- NULL
morpho$Collector.number <- NULL
morpho[morpho == "n/a"] <- NA
morpho <- na.omit(morpho)
morpho
# Check for duplicate rows
duplicate_rows <- duplicated(morpho$species)
duplicate_rows
morpho
# If there are duplicate rows, average them
if (any(duplicate_rows)) {
morpho <- morpho %>%
group_by(species) %>%
summarize_all(mean, na.rm = TRUE) %>%
ungroup()
}
morpho
View(morpho)
# Set measurement columns as numeric -- "n/a" can result in importing as character, causing MANOVA problems
cols.num <- c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", "secondary_axis_leaf_width", "bract_length", "bract_width", "auricle_length", "primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")
combined[cols.num] <- sapply(combined[cols.num],as.numeric)
head(combined)
# Define species as a model factor
combined$species <- as.factor(combined$species)
# Normalize data matrix
combined.nonnormalized <- combined
combined <- rapply(combined,scale,c("numeric","integer"),how="replace")
combined
#load and combine data
morpho <- read.csv("Symphyotrichum_morphometrics_final.csv", header = TRUE)
morpho$Barcode <- NULL
morpho$Collector <- NULL
morpho$Collector.number <- NULL
morpho[morpho == "n/a"] <- NA
morpho <- na.omit(morpho)
# Set measurement columns as numeric -- "n/a" can result in importing as character, causing MANOVA problems
cols.num <- c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", "secondary_axis_leaf_width", "bract_length", "bract_width", "auricle_length", "primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")
combined[cols.num] <- sapply(combined[cols.num],as.numeric)
head(combined)
#load and combine data
morpho <- read.csv("Symphyotrichum_morphometrics_final.csv", header = TRUE)
morpho$Barcode <- NULL
morpho$Collector <- NULL
morpho$Collector.number <- NULL
morpho[morpho == "n/a"] <- NA
morpho <- na.omit(morpho)
# Set measurement columns as numeric -- "n/a" can result in importing as character, causing MANOVA problems
cols.num <- c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", "secondary_axis_leaf_width", "bract_length", "bract_width", "auricle_length", "primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")
combined[cols.num] <- sapply(combined[cols.num],as.numeric)
head(combined)
# Define species as a model factor
combined$species <- as.factor(combined$species)
# Set measurement columns as numeric -- "n/a" can result in importing as character, causing MANOVA problems
cols.num <- c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", "secondary_axis_leaf_width", "bract_length", "bract_width", "auricle_length", "primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")
morpho[cols.num] <- sapply(morpho[cols.num],as.numeric)
head(mprpho)
head(morpho)
# Define species as a model factor
combined$species <- as.factor(combined$species)
# Normalize data matrix
combined.nonnormalized <- combined
combined <- rapply(combined,scale,c("numeric","integer"),how="replace")
# Define species as a model factor
morpho$species <- as.factor(morpho$species)
# Normalize data matrix
morpho.nonnormalized <- morpho
morpho <- rapply(morpho,scale,c("numeric","integer"),how="replace")
# Check for duplicate rows
duplicate_rows <- duplicated(morpho$species)
# If there are duplicate rows, average them
if (any(duplicate_rows)) {
morpho <- morpho %>%
group_by(species) %>%
summarize_all(mean, na.rm = TRUE) %>%
ungroup()
}
morpho
View(morpho)
classification=read.table("final_classification_k_6.csv", header = FALSE, sep = ",")
rownames(classification) <- classification[,1]
classification$V1<- NULL
combined <- merge(morpho, classification, by="row.names", all=TRUE)
combined <- na.omit(combined)
combined
combined
View(classification)
morpho
View(morpho)
classification
#################################
## subgenus analysis-- Virgulus
#################################
subgenus_virgulus <- c("Symphyotrichum bimater", "Symphyotrichum concolor", "Symphyotrichum pratense", "Symphyotrichum oblongifolium", "Symphyotrichum yukonense", "Symphyotrichum hintonii", "Symphyotrichum moranense", "Symphyotrichum patens", "Symphyotrichum adnatum", "Symphyotrichum walteri", "Symphyotrichum novae-angliae", "Symphyotrichum ericoides", "Symphyotrichum falcatum", "Symphyotrichum turneri", "Symphyotrichum purpurescens", "Symphyotrichum chihuahuense", "Symphyotrichum sericeum", "Symphyotrichum fendleri", "Symphyotrichum fontinale", "Symphyotrichum grandiflorum", "Symphyotrichum phlogifolium", "Symphyotrichum georgianum", "Symphyotrichum amethystinum", "Symphyotrichum plumosum", "Symphyotrichum lucayanum", "Symphyotrichum campestre", "Symphyotrichum estesii", "Symphyotrichum trilineatum", "Symphyotrichum pygmaeum")
combined_subset1 <- combined[combined$species %in% subgenus_virgulus,]
combined_subset1$species <- as.factor(as.character(combined_subset1$species))
combined_subset1$species = factor(combined_subset1$species, labels = gsub("Symphyotrichum ", "S.", levels(combined_subset1$species)))
str(combined_subset1)
#################################
## subgenus analysis-- Virgulus
#################################
subgenus_virgulus <- c("Symphyotrichum bimater", "Symphyotrichum concolor", "Symphyotrichum pratense", "Symphyotrichum oblongifolium", "Symphyotrichum yukonense", "Symphyotrichum hintonii", "Symphyotrichum moranense", "Symphyotrichum patens", "Symphyotrichum adnatum", "Symphyotrichum walteri", "Symphyotrichum novae-angliae", "Symphyotrichum ericoides", "Symphyotrichum falcatum", "Symphyotrichum turneri", "Symphyotrichum purpurescens", "Symphyotrichum chihuahuense", "Symphyotrichum sericeum", "Symphyotrichum fendleri", "Symphyotrichum fontinale", "Symphyotrichum grandiflorum", "Symphyotrichum phlogifolium", "Symphyotrichum georgianum", "Symphyotrichum amethystinum", "Symphyotrichum plumosum", "Symphyotrichum lucayanum", "Symphyotrichum campestre", "Symphyotrichum estesii", "Symphyotrichum trilineatum", "Symphyotrichum pygmaeum")
morpho_subset1 <- morpho[morpho$species %in% subgenus_virgulus,]
morpho_subset1$species <- as.factor(as.character(morpho_subset1$species))
morpho_subset1$species = factor(morpho_subset1$species, labels = gsub("Symphyotrichum ", "S.", levels(morpho_subset1$species)))
str(morpho_subset1)
combined <- merge(morpho, classification, by="row.names", all=TRUE)
combined <- na.omit(combined)
combined
morpho_subset1
View(morpho_subset1)
write.csv(morpho_subset1, "virgulus_morpho.csv")
#################################
## subgenus analysis-- Virgulus
#################################
subgenus_virgulus <- c("Symphyotrichum bimater", "Symphyotrichum concolor", "Symphyotrichum pratense", "Symphyotrichum oblongifolium", "Symphyotrichum yukonense", "Symphyotrichum hintonii", "Symphyotrichum moranense", "Symphyotrichum patens", "Symphyotrichum adnatum", "Symphyotrichum walteri", "Symphyotrichum novae-angliae", "Symphyotrichum ericoides", "Symphyotrichum falcatum", "Symphyotrichum turneri", "Symphyotrichum purpurescens", "Symphyotrichum chihuahuense", "Symphyotrichum sericeum", "Symphyotrichum fendleri", "Symphyotrichum fontinale", "Symphyotrichum grandiflorum", "Symphyotrichum phlogifolium", "Symphyotrichum georgianum", "Symphyotrichum amethystinum", "Symphyotrichum plumosum", "Symphyotrichum lucayanum", "Symphyotrichum campestre", "Symphyotrichum estesii", "Symphyotrichum trilineatum", "Symphyotrichum pygmaeum")
morpho_subset1 <- morpho[morpho$species %in% subgenus_virgulus,]
morpho_subset1$species <- as.factor(as.character(morpho_subset1$species))
str(morpho_subset1)
morpho_subset1
write.csv(morpho_subset1, "virgulus_morpho.csv")
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
myData
# Build the discriminant
library(MASS)
discriminant <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(species ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
myData
# Classification success
discriminant.jackknife <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(combined_subset1$habitat, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
# Build the discriminant
library(MASS)
discriminant <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(myData$habitat, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
# Predict species by the discriminant function
discriminant.prediction <- predict(discriminant)
# Create dataframe for plotting
plotdata1 <- data.frame(type = myData$species, lda = discriminant.prediction$x)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 2)
# Create dataframe for plotting
plotdata1 <- data.frame(type = myData$habitat, lda = discriminant.prediction$x)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 2)
ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
# Save as PDF
ggsave("habitat_morpho_plot.pdf", plot = plot, width = 12, height = 8)
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 8)
# Save as PDF
ggsave("habitat_morpho_plot.pdf", plot = plot, width = 12, height = 8)
plot
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 8)
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 8)
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 5)
plot
# Save as PDF
ggsave("habitat_morpho_plot.pdf", plot = plot, width = 10, height = 8)
# Save as PDF
ggsave("habitat_morpho_plot.pdf", plot = plot, width = 8, height = 6)
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
# Save as PDF
ggsave("habitat_morpho_plot.pdf", plot = plot, width = 8, height = 6)
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ habitat, data = myData)
summary(res.man)
# Break down variable importance
summary.aov(res.man)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
library(devtools)
library(pairwiseAdonis)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
View(myData)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
myData
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
# Build the discriminant
library(MASS)
discriminant <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(myData$habitat, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
library(dplyr)
#load and combine data
morpho <- read.csv("Symphyotrichum_morphometrics_final.csv", header = TRUE)
morpho$Barcode <- NULL
morpho$Collector <- NULL
morpho$Collector.number <- NULL
morpho[morpho == "n/a"] <- NA
morpho <- na.omit(morpho)
# Set measurement columns as numeric -- "n/a" can result in importing as character, causing MANOVA problems
cols.num <- c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", "secondary_axis_leaf_width", "bract_length", "bract_width", "auricle_length", "primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")
morpho[cols.num] <- sapply(morpho[cols.num],as.numeric)
head(morpho)
# Define species as a model factor
morpho$species <- as.factor(morpho$species)
# Normalize data matrix
morpho.nonnormalized <- morpho
morpho <- rapply(morpho,scale,c("numeric","integer"),how="replace")
# Check for duplicate rows
duplicate_rows <- duplicated(morpho$species)
# If there are duplicate rows, average them
if (any(duplicate_rows)) {
morpho <- morpho %>%
group_by(species) %>%
summarize_all(mean, na.rm = TRUE) %>%
ungroup()
}
morpho
classification=read.table("final_classification_k_6.csv", header = FALSE, sep = ",")
rownames(classification) <- classification[,1]
classification$V1<- NULL
combined <- merge(morpho, classification, by="row.names", all=TRUE)
combined <- na.omit(combined)
#################################
## subgenus analysis-- Virgulus
#################################
subgenus_virgulus <- c("Symphyotrichum bimater", "Symphyotrichum concolor", "Symphyotrichum pratense", "Symphyotrichum oblongifolium", "Symphyotrichum yukonense", "Symphyotrichum hintonii", "Symphyotrichum moranense", "Symphyotrichum patens", "Symphyotrichum adnatum", "Symphyotrichum walteri", "Symphyotrichum novae-angliae", "Symphyotrichum ericoides", "Symphyotrichum falcatum", "Symphyotrichum turneri", "Symphyotrichum purpurescens", "Symphyotrichum chihuahuense", "Symphyotrichum sericeum", "Symphyotrichum fendleri", "Symphyotrichum fontinale", "Symphyotrichum grandiflorum", "Symphyotrichum phlogifolium", "Symphyotrichum georgianum", "Symphyotrichum amethystinum", "Symphyotrichum plumosum", "Symphyotrichum lucayanum", "Symphyotrichum campestre", "Symphyotrichum estesii", "Symphyotrichum trilineatum", "Symphyotrichum pygmaeum")
morpho_subset1 <- morpho[morpho$species %in% subgenus_virgulus,]
morpho_subset1$species <- as.factor(as.character(morpho_subset1$species))
str(morpho_subset1)
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
# Build the discriminant
library(MASS)
discriminant <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(myData$habitat, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
# Predict species by the discriminant function
discriminant.prediction <- predict(discriminant)
# Create dataframe for plotting
plotdata1 <- data.frame(type = myData$habitat, lda = discriminant.prediction$x)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
plot
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ habitat, data = myData)
summary(res.man)
# Break down variable importance
summary.aov(res.man)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = habitat), size = 10)
plot
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
plot
# Create a custom color vector
custom_colors <- c("0" = "darkgreen",
"1" = "olivedrab3",
"3" = "steelblue",
"3" = "burlywood",
"4" = "purple")
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = custom_colors), size = 10)
plot
plotdata1
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = custom_colors), size = 10)
plot
# Create a bar chart with custom colors
ggplot(plotdata1, aes(lda.LD1, lda.LD2, fill = type)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) + # Use the custom color vector
labs(
title = "Population by Habitat",
x = "Habitat Type",
y = "Population",
fill = "Habitat"
) +
theme_minimal()
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
plot
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
myData
# Build the discriminant
library(MASS)
discriminant <- lda(species ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(species ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(myData$species, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
myData
sum(diag(prop.table(ct1)))
# Predict species by the discriminant function
discriminant.prediction <- predict(discriminant)
# Create dataframe for plotting
plotdata1 <- data.frame(type = myData$species, lda = discriminant.prediction$x)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
plot
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 6)
plot
# Save as PDF
ggsave("species_morpho_plot.pdf", plot = plot, width = 8, height = 6)
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ species, data = myData)
summary(res.man)
# Break down variable importance
summary.aov(res.man)
myData
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ species, data = myData)
summary(res.man)
res.man
# Multivariate MANOVA
res.man <- anova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ species, data = myData)
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
myData$habitat <- as.factor(as.character(myData$habitat))
str(myData)
# Build the discriminant
library(MASS)
discriminant <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(myData$habitat, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
# Predict species by the discriminant function
discriminant.prediction <- predict(discriminant)
# Create dataframe for plotting
plotdata1 <- data.frame(type = myData$habitat, lda = discriminant.prediction$x)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 10)
plot
# Save as PDF
ggsave("habitat_morpho_plot.pdf", plot = plot, width = 8, height = 6)
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ habitat, data = myData)
summary(res.man)
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 8)
# Save as PDF
ggsave("habitat_morpho_plot.pdf", plot = plot, width = 8, height = 6)
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ habitat, data = myData)
summary(res.man)
res.man
# Break down variable importance
summary.aov(res.man)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
library(pairwiseAdonis)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
myData
# Build the discriminant
library(MASS)
discriminant <- lda(species ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
discriminant
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
myData
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
myData$habitat <- as.factor(as.character(myData$habitat))
str(myData)
# Build the discriminant
library(MASS)
discriminant <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(myData$habitat, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
# Predict species by the discriminant function
discriminant.prediction <- predict(discriminant)
# Create dataframe for plotting
plotdata1 <- data.frame(type = myData$habitat, lda = discriminant.prediction$x)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 8)
plot
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ habitat, data = myData)
summary(res.man)
res.man
plotdata1
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ habitat, data = myData)
res.man
summary(res.man)
# Break down variable importance
summary.aov(res.man)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
library(pairwiseAdonis)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
#library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
# Assess SPECIES pairwise significance
# You must drop perfectly correlated values or you will get a rank deficiency error
library(devtools)
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwiseAdonis <- pairwise.adonis(myData[,c("phyllary_length", "phyllary_width", "primary_axis_leaf_length", "primary_axis_leaf_width", "secondary_axis_leaf_length", " secondary_axis_leaf_width", "bract_length", "bract_width", " auricle_length", " primary_axis_hair_length", "below_capitulum_hair_length", "ray_length", "ray_width")], myData$habitat, sim.method = "euclidean", p.adjust.m = "hochberg", perm = 10000)
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
myData$habitat <- as.factor(as.character(myData$habitat))
str(myData)
# Build the discriminant
library(MASS)
discriminant <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(myData$habitat, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
# Predict species by the discriminant function
discriminant.prediction <- predict(discriminant)
# Create dataframe for plotting
plotdata1 <- data.frame(type = myData$habitat, lda = discriminant.prediction$x)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 8)
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ habitat, data = myData)
summary(res.man)
plot
# Build the discriminant
library(MASS)
discriminant <- lda(species ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
# Classification success
discriminant.jackknife <- lda(species ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit", CV = TRUE)
ct1 <- table(myData$species, discriminant.jackknife$class)
sum(diag(prop.table(ct1)))
# Predict species by the discriminant function
discriminant.prediction <- predict(discriminant)
# Create dataframe for plotting
plotdata1 <- data.frame(type = myData$species, lda = discriminant.prediction$x)
library(ggplot2)
ggplot(plotdata1) + geom_boxplot(aes(lda.LD1, lda.LD2, colour = type))
plot <- ggplot(plotdata1) + geom_point(aes(lda.LD1, lda.LD2, colour = type), size = 6)
plot
# Multivariate MANOVA
res.man <- manova(cbind(phyllary_length, phyllary_width, primary_axis_leaf_length, primary_axis_leaf_width, secondary_axis_leaf_length, secondary_axis_leaf_width, bract_length, bract_width, auricle_length, primary_axis_hair_length, below_capitulum_hair_length, ray_length, ray_width) ~ species, data = myData)
summary(res.man)
res.man
myData <- read.csv("virgulus_habitat_morpho.csv", header = TRUE)
myData$habitat <- as.factor(as.character(myData$habitat))
str(myData)
# Build the discriminant
library(MASS)
discriminant <- lda(habitat ~ phyllary_length + phyllary_width + primary_axis_leaf_length + primary_axis_leaf_width + secondary_axis_leaf_length + secondary_axis_leaf_width + bract_length + bract_width + auricle_length + primary_axis_hair_length + below_capitulum_hair_length + ray_length + ray_width, data = myData, na.action="na.omit")
head(discriminant)
write.csv(discriminant, "means.csv")
write.csv(discriminant, "means.csv")
discriminant
